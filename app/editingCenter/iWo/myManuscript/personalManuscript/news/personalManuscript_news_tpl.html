<form name="newsForm" novalidate>
    <div class="row_news websiteOrIwo_timeLine_head_row_news plr20">
        <!-- <tabset class="subject-tab">
            <tab ng-click="goto('docInfo')" heading="稿件信息"></tab>
            <tab ng-click="goto('paramInfo')" heading="属性信息"></tab>
            <tab ng-click="goto('sendDoc')" heading="发稿单"></tab>
            <tab ng-click="goto('atlasProgress')" heading="流程版本" ng-if="data.hasVersionTime"></tab>
        </tabset> -->
        <ul class="subject-tab">
            <li>
                <a du-smooth-scroll du-scrollspy offset="20" duration="2000" href="#section-1">稿件信息</a>
            </li>
            <li>
                <a du-smooth-scroll du-scrollspy offset="60" duration="2000" href="#section-2">属性信息</a>
            </li>
            <li>
                <a du-smooth-scroll du-scrollspy offset="60" duration="2000" href="#section-3">发稿单</a>
            </li>
            <li ng-if="status.hasVersionTime">
                <a du-smooth-scroll du-scrollspy duration="2000" offset="60" href="#section-4">流程版本</a>
            </li>
        </ul>
        <div id="section-1">
            <div class="ht43" id="docInfo">
                <!--禁止form回车触发button请勿删除-->
                <button style="display:none"></button>
            </div>
            <div>
                <div class="row mc-padding-top-xs mr0">
                    <div class="col-md-8">
                        <div class="form-group clearfix">
                            <div class="col-sm-1 mc-padding-horizontal-0 text-right">引题：</div>
                            <div class="col-sm-10 mc-padding-horizontal-0">
                                <div class="invalidate-input-box {{newsForm.LEADTITLE.$invalid?'has-error':''}}">
                                    <input class="form-control" type="text" name="LEADTITLE" ng-model="list.LEADTITLE" placeholder="请输入引题" maxlength-error-message="长度不能超过200个字符！" validator="maxlength=200" ng-blur="showError(true)" ng-mouseenter="isShowTipsLEADTITLE=true" ng-mouseleave="isShowTipsLEADTITLE=false" is-show-tips="isShowTipsLEADTITLE">
                                </div>
                            </div>
                            <span class="col-sm-1 tip">共
                        <trs-word-num num-obj="{{list.LEADTITLE}}" class="font_red auto_wt"></trs-word-num>
                        字
                        </span>
                        </div>
                    </div>
                    <div class="col-md-2 pl0">
                        <div class="isORINGIN" ng-if="!list.ORIGINMETADATAID||list.ORIGINMETADATAID==0">
                            <!-- 是否原创: -->
                            <img class="edit_wOriginal isORINGIN_cursor" ng-click="oringin(list)" ng-src="./editingCenter/iWo/images/{{list.ORIGINAL==='0'?'or.png':'or-1.png'}}">
                            <p class="edit_wOriginal_p" ng-if="list.ORIGINAL === '1'">原创：已声明</p>
                            <input type="text" style="display:none" ng-model="list.ORIGINAL" name="isOriginal">
                        </div>
                        <div class="isORINGIN not-allowed" ng-if="list.ORIGINMETADATAID>0">
                            <!-- 是否原创: -->
                            <img class="edit_wOriginal isORINGIN_cursor" ng-src="./editingCenter/iWo/images/{{list.ORIGINAL==='0'?'or.png':'or-1.png'}}">
                            <p class="edit_wOriginal_p" ng-if="list.ORIGINAL === '1'">原创：已声明</p>
                            <input type="text" style="display:none" ng-model="list.ORIGINAL" name="isOriginal">
                        </div>
                    </div>
                    <!--肩题结束-->
                    <div class="col-md-8">
                        <div class="form-group clearfix">
                            <div class="col-sm-1 mc-padding-horizontal-0 text-right">
                                <!-- <em class="font_red">*</em> -->标题：
                            </div>
                            <div class="col-sm-10 mc-padding-horizontal-0">
                                <div class="invalidate-input-box {{newsForm.TITLE.$invalid?'has-error':''}}">
                                    <input class="form-control" type="text" name="Title" ng-model="list.TITLE" placeholder="请输入标题" maxlength-error-message="长度不能超过200个字数！" validator="maxlength=200" ng-blur="showError(true)" ng-mouseenter="isShowTipsA=true" ng-mouseleave="isShowTipsA=false" is-show-tips="isShowTipsA">
                                </div>
                            </div>
                            <span class="col-sm-1 tip">共
                        <trs-word-num num-obj="{{list.TITLE}}" class="font_red auto_wt"></trs-word-num>
                        字
                        </span>
                        </div>
                    </div>
                    <div class="col-md-2 pl0">
                        <!-- <div class="channel-radio-container">
                            <trs-single-radio ng-repeat="item in status.mediaTypes" ischecked="item.value==list.MEDIATYPES" label="{{item.desc}}" group="'mediaTypes'" callback="toggleRadio(item)" imgurl="{{item.imgurl}}"></trs-single-radio>
                        </div> -->
                    </div>
                    <!--标题结束-->
                    <div class="col-md-8">
                        <div class="form-group clearfix">
                            <div class="col-sm-1 mc-padding-horizontal-0 text-right">副标题：</div>
                            <div class="col-sm-10 mc-padding-horizontal-0">
                                <div class="invalidate-input-box {{newsForm.SUBTITLE.$invalid?'has-error':''}}">
                                    <input class="form-control" type="text" name="SUBTITLE" ng-model="list.SUBTITLE" placeholder="请输入副标题" maxlength-error-message="长度不能超过200个字符！" validator="maxlength=200" ng-blur="showError(true)" ng-mouseenter="isShowTipsSUBTITLE=true" ng-mouseleave="isShowTipsSUBTITLE=false" is-show-tips="isShowTipsSUBTITLE">
                                </div>
                            </div>
                            <span class="col-sm-1 tip">共
                            <trs-word-num num-obj="{{list.SUBTITLE}}" class="font_red auto_wt"></trs-word-num>
                            字
                             </span>
                        </div>
                    </div>
                    <div class="col-md-2 pl0">
                    </div>
                    <!--副标题结束-->
                </div>
            </div>
            <div class="mt20">
                <div class="m_box_item website-content-valid-error">
                    <div class="invalidate-input-box">
                        <div class="bigFaceDetail col-md-6 col-sm-6 bigFace">
                            <div class="bigFaceBorder">
                                <trs-big-face rel-el=".bigFaceDetailLeft"></trs-big-face>
                            </div>
                        </div>
                        <div ng-mouseenter="isShowTips_CONTENT=true" ng-mouseleave="isShowTips_CONTENT=false" class="bigFaceDetailLeft col-md-9 col-sm-8 mc-padding-horizontal-0 {{newsForm.content.$invalid?'content-error':''}}">
                            <!-- <tabset class="m_nav_3">
                        <tab heading="常规" active="true">
                            <div class="m_box_2">
                                编辑器
                            </div>
                        </tab>
                        <tab heading="插件"></tab>
                    </tabset> -->
                            <ueditorLocation>
                            </ueditorLocation>
                        </div>
                        <div class="col-md-3 col-sm-4 bigFaceDetailRigth">
                            <support-creation content="status.support.content"></support-creation>
                        </div>
                    </div>
                    <input type="text" class="ueditorReplace" is-show-tips="isShowTips_CONTENT" validator="required" name="content" ng-model="list.HTMLCONTENT" />
                </div>
            </div>
        </div>
        <div class="mt20" id="section-2">
            <div class="edit-news-title">
                属性信息
            </div>
            <div class="m_box box_bg">
                <div class="m_box_item mt10">
                    <div class="col-sm-1 text-right">新闻来源：</div>
                    <div class="col-sm-10">
                        <div class="suggestion">
                            <input class="form-control edit-news-attribute-text" type="text" watch-options='true' ng-model="list.NEWSSOURCES" bs-options="user as user.SRCNAME for user in getSuggestions($viewValue)" bs-typeahead limit="30">
                        </div>
                    </div>
                </div>
                <div class="m_box_item mt20">
                    <div class="col-sm-1 text-right">作者：</div>
                    <div class="col-sm-10">
                        <div class="invalidate-input-box {{newsForm.SIGNAUTHOR.$invalid?'has-error':''}}">
                            <input class="form-control edit-news-attribute-text" type="text" name="SIGNAUTHOR" ng-model="list.SIGNATUREAUTHOR" placeholder="请输入署名作者" maxlength-error-message="长度不能超过50个字符！" validator="maxlength=50" ng-blur="showError(true)" ng-mouseenter="isShowTipsC=true" ng-mouseleave="isShowTipsC=false" is-show-tips="isShowTipsC">
                        </div>
                    </div>
                </div>
                <div class="m_box_item mt20">
                    <div class="col-sm-1 text-right">
                        关键词：
                    </div>
                    <div class="col-sm-10">
                        <span class="errorTips" ng-show="isShowKeywordTips"><p class="validation-invalid">{{keywordsTips}}</p><i></i></span>
                        <div class="edit-news-attribute-text pull-left iwo-keywords-input-lengthen">
                            <tags-input ng-model="data.KEYWORDS" text="KEYWORDTEXT" add-on-space="true" add-on-enter="false" add-on-blur="true" ng-mouseenter="enter()" ng-mouseleave="leave()" add-on-comma="false" add-on-paste="true" paste-split-pattern="[;]" replace-spaces-with-dashes="false" enable-editing-last-tag="true" spellcheck="false" display-property="name" template="tag-template" min-length="1" max-length="20" placeholder="请输入关键词，以空格完成输入" allowed-tags-pattern="" on-invalid-tag="invalidTag($tag)" on-tag-adding="checkTag($tag)">
                            </tags-input>
                        </div>
                        <!-- <button ng-click="getKeywordsOrAbstract('keywords')" class="iwo-get-keywords iwo_get_keywords_btn">提取关键词</button>
                        <button ng-click="clearAllKeywords()" class="iwo-get-keywords iwo_get_keywords_btn">清除所有关键词</button> -->
                        <script type="text/ng-template" id="tag-template">
                            <div style="float: left; padding-left: 2px">
                                <span>{{$getDisplayText()}}</span>
                                <a class="remove-button" ng-click="$removeTag()">&times;</a>
                            </div>
                        </script>
                    </div>
                </div>
                <div class="m_box_item websiteaudiovideo">
                    <div class="col-sm-1 txt_r">音频视频：</div>
                    <div class="col-sm-11">
                        <ul class="audiovideo">
                            <li ng-init="getAudioVideoPlayer(item)" ng-repeat="item in status.audioVideoidsArray">
                                <video ng-if="item.value.streamsMap.l!=undefined" controls="controls" ng-src="{{item.value.streamsMap.l.httpURL}}"></video>
                                <div ng-if="item.value.err!=undefined" class="default">
                                    <span><img src="./editingCenter/website/images/video.gif" alt="请稍等，正在转码..."></span>
                                </div>
                                <div class="toolbar">
                                    <label ng-click="deleteAudioVideo(item)">删除</label>
                                    <label ng-click="downloadAudioVideo(item.id)" ng-if="item.value.streamsMap.l.httpURL!=undefined">下载</label>
                                </div>
                            </li>
                            <li class="edit-UploadMasProgress" ng-if="status.uploadMasNow">
                                <div>
                                    <p ng-style="{'width':status.uploadMasProgress}"></p>
                                </div>
                                <span ng-bind="status.uploadMasProgress"></span>
                            </li>
                        </ul>
                        <div>
                            <div class="edit-UploadMasBtn" trs-Mas-upload call-back="uploadMasCallBack" extensions="status.masUploadExtensions" mime-types="status.masUploadMimeTypes" multiple="false">
                            </div>
                            <!--  <img class="audiovideo" ng-model="status.tempAppendix" ngf-select="chooseFile()" ngf-validate="{pattern: '.mp3,.mp4,.rmvb,.flv,.avi'}" src="./editingCenter/app/toBeCompiled/images/b14.png" ng-click="uploadAudioVideo()" /> -->
                            <p class="cue"><span>支持格式：</span>
                                <span>.mp3,.mp4,.flv,.rmvb,.avi</span></p>
                        </div>
                    </div>
                </div>
                <div cg-busy="uploadPromise"></div>
                <div class="m_box_item">
                    <div class="col-sm-1 txt_r">音视频地址：</div>
                    <div class="col-sm-11 invalidate-input-box">
                        <input type="text" name="videoUrl" placeholder="http://开头" ng-model="list.AUDIOVIDEOURL" validator="maxlength=500,url" ng-mouseenter="isShowTipsV=true" ng-mouseleave="isShowTipsV=false" is-show-tips="isShowTipsV" class="form-control w352">
                    </div>
                </div>
                <div class="m_box_item mt20">
                    <div class="col-sm-1 text-right">摘要：</div>
                    <div class="col-sm-7 invalidate-input-box {{newsForm.ABSTRACT.$invalid&&newsForm.ABSTRACT.$dirty?'has-error':''}}">
                        <textarea class="form-control edit-news-textarea" name="ABSTRACT" ng-model="list.ABSTRACT" maxlength-error-message="长度不能超过500个字符！" validator="maxlength=500" ng-mouseenter="isShowTips=true" ng-mouseleave="isShowTips=false" is-show-tips="isShowTips">
                        </textarea>
                    </div>
                    <span class="iwoAbstractWordCount"><span>您已输入<span ng-bind="list.ABSTRACT==undefined?0:list.ABSTRACT.length"></span>个字符</span>
                    </span>
                    <!-- <button ng-click="getKeywordsOrAbstract('abstract')" class="iwo-get-iabstract iwo_get_iabstract_btn">提取摘要</button> -->
                </div>
                <div class="m_box_item mt20">
                    <div class="col-sm-1 text-right">备注：</div>
                    <div class="col-sm-7 invalidate-input-box {{newsForm.REMARK.$invalid&&newsForm.REMARK.$dirty?'has-error':''}}">
                        <textarea class="form-control edit-news-textarea" name="REMARK" ng-model="list.REMARKS" maxlength-error-message="长度不能超过500个字符！" validator="maxlength=500" ng-mouseenter="isShowTips=true" ng-mouseleave="isShowTips=false" is-show-tips="isShowTips">
                        </textarea>
                    </div>
                </div>
                <div class="m_box_item pd10">
                    <div class="col-sm-1 txt_r">新闻附件：</div>
                    <div class="col-sm-11">
                        <div class="website-file-upload">
                            <div class="website-file-upload-icon"></div>
                            <div class="website-file-upload-button" ngf-select ng-model="status.files" ngf-multiple="true" ngf-keep="'distinct'" ngf-change="selectFiles($files, $file, $newFiles)" multiple></div>
                        </div>
                        <table class="table table-striped table-bordered file-uploader-table" ng-if="status.showFiles.length>0 || list.ATTACHFILE.length>0">
                            <thead>
                                <tr>
                                    <th width="30%">附件名称</th>
                                    <th width="30%">附件描述</th>
                                    <th width="20%">操作</th>
                                    <th width="20%">状态</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- 附件上传和待上传的列表 -->
                                <tr ng-repeat="file in status.showFiles">
                                    <td>
                                        <div class="invalidate-input-box">
                                            <input type="text" ng-model="file.SRCFILE" name="filename" class="form-control" maxlength-error-message="长度不能超过200个字数！" validator="maxlength=200,required" ng-mouseenter="$index=true" ng-mouseleave="$index=false" is-show-tips="$index">
                                        </div>
                                    </td>
                                    <td>
                                        <div class="invalidate-input-box">
                                            <input type="text" ng-model="file.APPDESC" name="filedesc" class="form-control" maxlength-error-message="长度不能超过200个字数！" validator="maxlength=200,required" ng-mouseenter="$index=true" ng-mouseleave="$index=false" is-show-tips="$index">
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-danger btn-xs" ng-click="removeCurFile(file,$index)">
                                            <span class="glyphicon glyphicon-trash"></span> 移除
                                        </button>
                                    </td>
                                    <td class="multiImgsUploader">
                                        <img ng-if="file.FILEINFO=='上传成功'" src="./manageConfig/productManageMent/images/n5.png" />
                                        <img ng-if="file.FILEINFO!=='上传成功'&&file.FILEINFO!=='等待上传'&&file.FILEINFO!=='上传中'" src="./planningCenter/images/gl50.png" />
                                        <img ng-if="file.FILEINFO=='等待上传'" src="./editingCenter/website/images/wait.png" />
                                        <img ng-if="file.FILEINFO=='上传中'" src="./editingCenter/newspaper/images/loading2.gif" />
                                        <span ng-bind="file.FILEINFO" class="text"></span>
                                        <!-- <div class="progress file-progress" ng-show="!file.PERPICURL">
                                            <span class="percentage" ng-style="{'width':file.progressPercentage}"></span>
                                        </div> -->
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="4">
                                        <button type="submit" class="btn btn-success btn-xs website-upload-btn" ng-click="fileSubmit()" ng-disabled="status.isUploaderFile==false">
                                            <span class="glyphicon glyphicon-upload"></span> 上传
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div id="section-3">
            <div class="mtb20">
                <div class="edit-news-title blueborder">
                    <p class="pull-left">发稿单</p>
                    <label class="edit-news-checkbox">
                        <trs-checkbox ischecked="list.ISNOPAYMENT==='1'" label="不发稿费" callback="updateCKSelection(list)"></trs-checkbox>
                    </label>
                </div>
                <div class="m_box_item mt20 ml15">
                    稿件体裁：
                    <trs-single-select selected-option="list.DOCGENRE" options="DOCGENRES"></trs-single-select>
                </div>
            </div>
            <editor>
            </editor>
            <!-- <editor-dir meta-data-id="{{list.METADATAID}}" editor-json="list.FGD_EDITINFO" show-all-tips="showAllTips" editor-form="newsForm"></editor-dir>
                <editor-auth-dir author="list.FGD_AUTHINFO"></editor-auth-dir> -->
            <!--   <editor-auth-dir author="list.FGD_AUTHINFO" class="last_item_mb"></editor-auth-dir> -->
        </div>
        <div class='timeline' ng-if="status.hasVersionTime" id="section-4">
            <div class="subject-title mt20">流程版本</div>
            <tabset class="m_nav_3 mt20">
                <tab heading="操作日志">
                    <div class="m_box_2">
                        <trs-timeline title="'操作日志'">
                            <p ng-bind="data.version.operationLogTitle" class="logTitle"></p>
                            <div ng-repeat="(key, value) in data.version.group">
                                <h3 ng-class="{'operateLog':$index%2==0}">{{key}}</h3>
                                <timegroup tick="item.day" ng-repeat="item in data.version.operationLog[key]">
                                    <timeitem tick="n.value.CRTIME" ng-repeat="n in item.times">
                                        <a class="minw45">{{n.value.OPERATION}}</a>
                                        <a class="minw80 pointer" ng-bind="n.value.USERNAME" title="{{n.value.OPERUSERNAME}}"></a>
                                        <a class="minw88" title="{{n.value.ATTRIBUTE}}" ng-bind="n.value.DESUSERNAME||n.value.ATTRIBUTE"></a>
                                        <a title="{{n.value.OPINION}}" class="exttype" ng-if="n.value.OPINION!==''">{{n.value.OPERATION}}意见</a>
                                    </timeitem>
                                </timegroup>
                            </div>
                        </trs-timeline>
                    </div>
                    <div class="websist_normal" ng-if="page.CURRPAGE>=page.PAGECOUNT">没有更多了...</div>
                    <div data-ng-if="page.CURRPAGE<page.PAGECOUNT" cg-busy="loadingPromise" class="website_timeline_load_more_2 text-center" ng-click="getLoadMore()">
                        <img src="./editingCenter/website/images/images/newTab_2.png" /> 点击展开更多
                    </div>
                </tab>
                <tab heading="流程版本">
                    <div class="m_box_2">
                        <trs-timeline title="'流程版本'">
                            <timegroup tick="item.day" ng-repeat="item in data.version.versionTime">
                                <timeitem tick="n.value.CRTIME" ng-repeat="n in item.times">
                                    <a class="minw45">{{n.value.OPERATION}}</a>
                                    <a class="minw80" title="{{n.value.OPERSTATEDESC|trsLimitTo:12}}">{{n.value.OPERSTATEDESC}}</a>
                                    <a class="minw88">{{n.value.CRUSER}}</a>
                                    <a class="exttype" target="_blank" ui-sref="editingCenterPersonalVersionTime({objectversionid:n.value.OBJECTVERSIONID})">{{n.value.EXTTYPE}}</a>
                                </timeitem>
                            </timegroup>
                        </trs-timeline>
                    </div>
                </tab>
                <tab heading="评审意见">
                    <div class="m_box_2 edit_versionTime_comment">
                        <trs-timeline title="'评审意见'">
                            <timegroup tick="item.day" ng-repeat="item in data.comment.comment">
                                <timeitem tick="n.value.CRTIME" ng-repeat="n in item.times">
                                    <a class="minw80 comment_name" ng-bind="n.value.TRUENAME"></a>
                                    <a ng-bind="n.value.COMMENT" ng-if="n.value.COMMTYPE==1" class="comment_content"></a>
                                    <audio preload controls ng-src="{{trustUrl(data.comment.voiceObj[n.value.COMMENT])}}" ng-if="n.value.COMMTYPE==2"></audio>
                                    <!-- <span ng-bind="n.value.DURATION+' 秒'" class="comment_duration" ng-if="n.value.COMMTYPE==2"></span> -->
                                </timeitem>
                            </timegroup>
                        </trs-timeline>
                    </div>
                    <div class="websist_normal" ng-if="!data.comment.hasMore">没有更多了...</div>
                    <div data-ng-if="data.comment.hasMore" cg-busy="loadingPromise" class="website_timeline_load_more_2 text-center" ng-click="getLoadMoreComment()">
                        <img src="./editingCenter/website/images/images/newTab_2.png" /> 点击展开更多
                    </div>
                </tab>
            </tabset>
        </div>
    </div>
    <div class="Iw-box-fix box-fix-bt">
        <div class="txt_r">
            <button class="btn btn-primary" ng-click="bigFace(list)" ng-if="!!status.bigFaceRigths['iwo.trace.chakan']&&!bigFaceHide">
                <span class="s_icon">
                    <img ng-src="./editingCenter/app/toBeCompiled/images/b9.png" /> 
                </span><span class="bitFaceTit" ng-bind="status.bitFaceTit" ng-click=""></span>
            </button>
            <button class="btn btn-primary" ng-repeat="btn in arrayBtn track by $index" ng-click="handleBtnClick(btn.OPERFUN)" ng-disabled="!status.openBtn">
                <span class="s_icon">
                    <img ng-src="./editingCenter/iWo/images/c{{btn.RIGHTINDEX}}.png"></span> {{btn.OPERDESC}}
            </button>
        </div>
    </div>
</form>
<div cg-busy="loadingPromise"></div>
